<section class="bg-[#FAF8F1] min-h-screen py-12 px-4 md:px-8">
    <div class="max-w-6xl mx-auto">
        <div class="h-24 w-full"></div>

        <div class="text-center mb-10">
            <h1 class="text-3xl lg:text-4xl font-serif font-bold text-[#5b4f47] mb-2">
                Gesti√≥n de Pacientes
            </h1>
            <div class="w-24 h-1 bg-[#d2bd8b] mx-auto rounded-full"></div>
        </div>

        <div class="bg-white p-8 rounded-3xl shadow-xl shadow-[#5b4f47]/5 border border-[#d2bd8b]/20 mb-12">
            <h2 class="text-xl font-bold text-[#5b4f47] mb-6 flex items-center gap-2">
                <span class="text-[#d2bd8b] text-2xl">{{ editando ? '‚úèÔ∏è' : 'üìã' }}</span>
                {{ editando ? 'Editar Expediente' : 'Nuevo Registro' }}
            </h2>

            <form (ngSubmit)="guardar()" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">

                <div class="space-y-1">
                    <label class="text-xs font-bold text-[#8c7e70] uppercase pl-1">Nombre Completo</label>
                    <input [(ngModel)]="nuevoPaciente.nombre" name="nombre" type="text" placeholder="Ej: Mar√≠a L√≥pez"
                        required
                        class="w-full px-4 py-3 rounded-xl bg-[#FAF8F1] border border-[#d2bd8b]/30 text-[#5b4f47] focus:ring-2 focus:ring-[#d2bd8b] focus:border-transparent outline-none transition-all">
                </div>

                <div class="space-y-1">
                    <label class="text-xs font-bold text-[#8c7e70] uppercase pl-1">Tratamiento</label>
                    <div class="relative">
                        <select [(ngModel)]="nuevoPaciente.tratamiento" name="tratamiento" required
                            class="w-full px-4 py-3 rounded-xl bg-[#FAF8F1] border border-[#d2bd8b]/30 text-[#5b4f47] focus:ring-2 focus:ring-[#d2bd8b] focus:border-transparent outline-none transition-all appearance-none cursor-pointer">
                            <option value="" disabled selected>Selecciona una opci√≥n...</option>
                            <option value="Consulta General">Consulta General</option>
                            <option value="Limpieza Dental">Limpieza Dental</option>
                            <option value="Ortodoncia">Ortodoncia</option>
                            <option value="Blanqueamiento">Blanqueamiento</option>
                            <option value="Dise√±o de Sonrisa">Dise√±o de Sonrisa</option>
                            <option value="Implantes">Implantes</option>
                            <option value="Endodoncia">Endodoncia</option>

                        </select>
                        <div
                            class="absolute inset-y-0 right-0 flex items-center px-4 pointer-events-none text-[#d2bd8b]">
                            <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20">
                                <path
                                    d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" />
                            </svg>
                        </div>
                    </div>
                </div>

                <div class="space-y-1">
                    <label class="text-xs font-bold text-[#8c7e70] uppercase pl-1">Email</label>
                    <input [(ngModel)]="nuevoPaciente.email" name="email" type="email" placeholder="correo@ejemplo.com"
                        required
                        class="w-full px-4 py-3 rounded-xl bg-[#FAF8F1] border border-[#d2bd8b]/30 text-[#5b4f47] focus:ring-2 focus:ring-[#d2bd8b] focus:border-transparent outline-none transition-all">
                </div>

                <div class="space-y-1">
                    <label class="text-xs font-bold text-[#8c7e70] uppercase pl-1">Tel√©fono</label>
                    <input [(ngModel)]="nuevoPaciente.telefono" name="telefono" type="tel" placeholder="099..." required
                        class="w-full px-4 py-3 rounded-xl bg-[#FAF8F1] border border-[#d2bd8b]/30 text-[#5b4f47] focus:ring-2 focus:ring-[#d2bd8b] focus:border-transparent outline-none transition-all">
                </div>

                <div class="md:col-span-2 lg:col-span-4 flex gap-3 justify-end mt-4">
                    @if(editando) {
                    <button type="button" (click)="cancelarEdicion()"
                        class="px-6 py-3 rounded-full border-2 border-[#5b4f47] text-[#5b4f47] font-bold hover:bg-[#5b4f47] hover:text-white transition-colors">
                        Cancelar
                    </button>
                    }
                    <button type="submit"
                        class="px-8 py-3 rounded-full bg-[#d2bd8b] text-white font-bold hover:bg-[#c2ad7b] shadow-lg hover:shadow-[#d2bd8b]/40 transition-all transform hover:-translate-y-1">
                        {{ editando ? 'Guardar Cambios' : 'Registrar Paciente' }}
                    </button>
                </div>
            </form>
        </div>

        <div class="bg-white rounded-3xl shadow-xl shadow-[#5b4f47]/5 border border-[#d2bd8b]/20 overflow-hidden">
            <div class="overflow-x-auto">
                <table class="w-full text-left border-collapse">
                    <thead class="bg-[#5b4f47] text-[#FAF8F1]">
                        <tr>
                            <th class="p-5 font-bold uppercase text-xs tracking-wider">Paciente</th>
                            <th class="p-5 font-bold uppercase text-xs tracking-wider">Tratamiento</th>
                            <th class="p-5 font-bold uppercase text-xs tracking-wider">Contacto</th>
                            <th class="p-5 font-bold uppercase text-xs tracking-wider text-right">Acciones</th>
                        </tr>
                    </thead>

                    <tbody class="divide-y divide-[#d2bd8b]/20">
                        @for (paciente of listaPacientes(); track paciente.id) {
                        <tr class="hover:bg-[#FAF8F1]/50 transition-colors group">

                            <td class="p-5">
                                <div style="display: flex; align-items: center; gap: 15px;">

                                    <img [src]="'https://api.dicebear.com/9.x/lorelei/svg?seed=' + paciente.nombre"
                                        alt="Avatar de paciente"
                                        style="width: 45px; height: 45px; border-radius: 50%; background-color: #fce7f3; padding: 5px;">

                                    <div>
                                        <div class="font-bold text-[#5b4f47]">{{ paciente.nombre }}</div>
                                        <div class="text-xs text-[#d2bd8b] font-mono mt-1">ID: {{ paciente.id |
                                            slice:0:5 }}...</div>
                                    </div>

                                </div>
                            </td>

                            <td class="p-5">
                                <span
                                    class="px-3 py-1 rounded-full bg-[#d2bd8b]/10 text-[#5b4f47] text-xs font-bold uppercase border border-[#d2bd8b]/20">
                                    {{ paciente.tratamiento || 'General' }}
                                </span>
                            </td>

                            <td class="p-5 text-sm text-[#8c7e70]">
                                <div class="flex items-center gap-2 mb-1">
                                    üìß {{ paciente.email }}
                                </div>
                                <div class="flex items-center gap-2">
                                    üì± {{ paciente.telefono }}
                                </div>
                            </td>

                            <td class="p-5 text-right space-x-2">
                                <button (click)="editar(paciente)"
                                    class="inline-flex items-center justify-center w-8 h-8 rounded-full bg-blue-50 text-blue-600 hover:bg-blue-500 hover:text-white transition-colors border border-blue-100"
                                    title="Editar">
                                    ‚úèÔ∏è
                                </button>
                                <button (click)="eliminar(paciente.id!)"
                                    class="inline-flex items-center justify-center w-8 h-8 rounded-full bg-red-50 text-red-600 hover:bg-red-500 hover:text-white transition-colors border border-red-100"
                                    title="Eliminar">
                                    üóëÔ∏è
                                </button>
                            </td>
                        </tr>
                        } @empty {
                        <tr>
                            <td colspan="4" class="p-12 text-center text-[#8c7e70]">
                                <div class="text-4xl mb-2">üìÇ</div>
                                <p>No hay pacientes registrados a√∫n.</p>
                            </td>
                        </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>

    </div>
</section>